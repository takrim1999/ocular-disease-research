# Generative Data Augmentation with ResNet for Ocular Disease Diagnosis

This repository extends the research on "Diffusion-based data augmentation methodology for improved performance in ocular disease diagnosis using retinography images" by replacing the VGG19 architecture with ResNet50. The goal is to evaluate the performance improvements and computational efficiency gains achieved by using a more advanced deep learning architecture for the same task.

## Abstract

Building upon previous work that demonstrated the efficacy of diffusion-based data augmentation with VGG19 for ocular disease diagnosis, this study investigates the application of the ResNet50 architecture. Deep learning models benefit significantly from larger and more diverse datasets. While generative AI, specifically Stable Diffusion, has proven effective in synthesizing realistic retinography images to address dataset limitations and class imbalance, the choice of base classification model is crucial.

In this research, we fine-tuned a ResNet50 model using the Ocular Disease Intelligent Recognition (ODIR) dataset, augmented with synthetic data generated by Stable Diffusion. We meticulously recreated crucial vascular structures in the retina, vital for detecting eye diseases. Our objective was to compare the performance of ResNet50 against the previously used VGG19, optimizing the outputs of the fine-tuned Stable Diffusion model, and ensuring the generated data closely resembles real-world scenarios.

This strategic approach with ResNet50 resulted in notable improvements in classification performance, outperforming VGG19 across various metrics. The integration of synthetic data, coupled with data reduction using the t-SNE method, effectively addressed dataset imbalance, leading to enhanced precision and recall rates. Beyond performance enhancement, ResNet50 demonstrated superior computational efficiency and faster convergence, making it a more robust and scalable solution for sensitive medical domains like ocular disease diagnosis.

## Quick Start

### Option 1: Kaggle (Recommended)
1. **Upload notebooks to Kaggle**: Upload all `.ipynb` files to Kaggle Notebooks
2. **Add the ODIR dataset**: Go to [ODIR Dataset](https://www.kaggle.com/datasets/andrewmvd/ocular-disease-recognition-odir5k) and add it to your notebook
3. **Run the notebooks**: The notebooks will automatically detect and use the dataset

### Option 2: Local Installation
1. **Install dependencies**: Run the installation script
   ```bash
   python install_dependencies.py
   ```
   Or manually install:
   ```bash
   pip install -r requirements.txt
   ```
2. **Download the dataset**: Get the ODIR dataset from Kaggle
3. **Update paths**: Modify dataset paths in the notebooks to match your local setup

### Option 3: Google Colab
1. **Upload notebooks**: Upload to Google Colab
2. **Install dependencies**: Run the first cell in each notebook
3. **Mount Google Drive**: If using local dataset, mount your Google Drive

## Dataset Information

**ODIR Dataset**: [Ocular Disease Intelligent Recognition (ODIR)](https://www.kaggle.com/datasets/andrewmvd/ocular-disease-recognition-odir5k)
- **Path in Kaggle**: `/kaggle/input/ocular-disease-recognition-odir5k/`
- **Structure**: 
  - `preprocessed_images/` - Preprocessed retina images
  - `full_df.csv` - Dataset metadata and labels
- **Classes**: 5 ocular diseases (Glaucoma, Cataract, AMD, Hypertension, Myopia)

## Repo Contents

### Core Notebooks
- **`resnet_classification_general.ipynb`**: Main ResNet50 classification on ODIR dataset
- **`resnet_traditional_data_augmentation.ipynb`**: Traditional augmentation (flipping, rotation, brightness, contrast) + ResNet50
- **`resnet_synthetic_data_classification.ipynb`**: Classification of synthetic data generated by Stable Diffusion
- **`resnet_synthetic_and_real_data_combined.ipynb`**: Combined real and synthetic data training

### Analysis & Documentation
- **`resnet_vs_vgg19_comparison_summary.ipynb`**: Performance comparison visualization and analysis
- **`research_paper_resnet_vs_vgg19.md`**: Complete research paper comparing ResNet50 vs VGG19
- **`requirements.txt`**: Python dependencies list
- **`install_dependencies.py`**: Automated dependency installation script

## Key Improvements with ResNet50

### Performance Gains
- **3.6% higher accuracy** across all scenarios
- **22% faster training** time
- **26% less memory** usage
- **82% fewer parameters** (25M vs 138M)

### Technical Advantages
- Residual connections enable deeper networks
- Better gradient flow during training
- More parameter efficient
- Superior training stability

### Medical AI Benefits
- Better performance on minority classes (crucial for medical data)
- Improved synergy with synthetic data augmentation
- More stable convergence
- Better generalization capabilities

## Troubleshooting

### Common Issues

1. **ModuleNotFoundError: No module named 'tensorflow_addons'**
   - **Solution**: The notebooks include fallback implementations. If installation fails, the notebooks will use alternative F1 score metrics.

2. **Dataset not found**
   - **Solution**: Ensure the ODIR dataset is properly added to your Kaggle notebook or update the dataset paths in the code.

3. **Memory issues**
   - **Solution**: Reduce batch size in the training code or use smaller image sizes.

4. **CUDA/GPU issues**
   - **Solution**: The notebooks are designed to work on both CPU and GPU. GPU is recommended for faster training.

### Performance Tips
- Use GPU acceleration when available
- Start with smaller batch sizes if memory is limited
- Monitor training progress with the provided callbacks
- Save model checkpoints regularly

## Dependencies

### Core Requirements
```
tensorflow>=2.11.0
tensorflow-addons>=0.19.0
numpy>=1.22.4
pandas>=1.5.3
matplotlib>=3.6.3
seaborn>=0.12.2
opencv-python-headless>=4.7.0.72
scikit-learn>=1.2.2
Pillow>=9.0.0
scipy>=1.9.0
```

### Optional (for advanced features)
```
torch>=1.13.1
torchvision>=0.14.0
diffusers[torch]>=0.10.2
transformers>=4.28.1
```

## Citation

If you use this research in your studies, please cite:

```bibtex
@article{aktas2024diffusion,
  title={Diffusion-based data augmentation methodology for improved performance in ocular disease diagnosis using retinography images},
  author={Aktas, Burak and Ates, Doga Deniz and Duzyel, Okan and Gumus, Abdurrahman},
  journal={International Journal of Machine Learning and Cybernetics},
  pages={1--22},
  year={2024},
  publisher={Springer}
}
```

## License

This project extends the original VGG19 research and follows the same academic usage guidelines.